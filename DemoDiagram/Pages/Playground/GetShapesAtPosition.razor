@page "/playground/getShapesAtPosition"

<svg id="canvas" width="801" height="481" xmlns="http://www.w3.org/2000/svg" @onmousemove="OnMouseMove">
    <defs>
        <pattern id="smallGrid" width="8" height="8" patternUnits="userSpaceOnUse">
            <path id="smallGridPath" d="M 8 0 H 0 V 8" fill="none" stroke="gray" stroke-width="0.5" />
        </pattern>
        <pattern id="largeGrid" width="80" height="80" patternUnits="userSpaceOnUse">
            <rect id="largeGridRect" width="80" height="80" fill="url(#smallGrid)" />
            <!-- draw from upper right to upper left, then down to lower left -->
            <!-- This creates the appearance of an 80x80 grid when stacked -->
            <path id="largeGridPath" d="M 80 0 H 0 V 80" fill="none" stroke="gray" stroke-width="2" />
        </pattern>

        <marker id="sid-2F05C12A-F392-4FBD-8D13-F5DCC6D4F6F8start" refX="1" refY="5" markerUnits="userSpaceOnUse"
            markerWidth="17" markerHeight="11" orient="auto">
            <!-- <path id="conditional"   d="M 0 6 L 8 1 L 15 5 L 8 9 L 1 5" fill="white" stroke="black" stroke-width="1" /> -->
            <path id="sid-2F05C12A-F392-4FBD-8D13-F5DCC6D4F6F8default" d="M 5 0 L 11 10" fill="white" stroke="#585858"
                stroke-width="1" display="none"></path>
        </marker>
        <marker id="sid-2F05C12A-F392-4FBD-8D13-F5DCC6D4F6F8end" refX="15" refY="6" markerUnits="userSpaceOnUse"
            markerWidth="15" markerHeight="12" orient="auto">
            <path id="sid-2F05C12A-F392-4FBD-8D13-F5DCC6D4F6F8arrowhead" d="M 0 1 L 15 6 L 0 11z" fill="#585858"
                stroke="#585858" stroke-linejoin="round" stroke-width="2"></path>
        </marker>
    </defs>

    <!-- a trick from my old Commodore 64 days is to extend the scrolling region beyond the viewport 
  and use mod 80 to reset the position to simulate a virtual space. -->
    <g id="surface" x="-80" y="-80" width="961" height="641">
        <rect id="grid" x="-80" y="-80" width="961" height="641" fill="url(#largeGrid)" />
    </g>

    <g id="stencils">
         @* <circle transform="translate(0,0)" cx="150" cy="100" r="40" stroke="black" stroke-width="1" fill="#FFFFFF"
            /> *@

            <rect  x="@position.X" y="@position.Y" transform="@translation.ToTranslate()"  width="@width" height="@height" rx="10" ry="10" stroke="#bbbbbb" stroke-width="1" fill="#f9f9f9"></rect>


    </g>
</svg>

<div>
    @if(GotIt !=null) {
        <span>Got shape at position: @GotIt.X @GotIt.Y</span>
    }
</div>